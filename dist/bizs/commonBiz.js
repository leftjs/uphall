// Generated by CoffeeScript 1.10.0
(function() {
  var db, validateUserInfo;

  db = require('./../libs/db');

  validateUserInfo = function(req, res, next) {
    var token;
    if (req.path === '/api/users/login' || req.path === '/api/users/register') {
      return next();
    } else {
      token = req.header('x-token');
      return db.users.findOne({
        token: token,
        expiredTime: {
          $gt: Date.now()
        }
      }, function(err, user) {
        if (!err) {
          req.userInfo = user;
        }
        if (user) {
          return next();
        } else {
          return next("未传token或者token出错");
        }
      });
    }
  };

  module.exports = {
    validateUserInfo: validateUserInfo
  };

}).call(this);

//# sourceMappingURL=commonBiz.js.map
